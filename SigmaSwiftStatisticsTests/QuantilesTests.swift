//
//  QuantilesTests.swift
//  SigmaSwiftStatistics
//
//  Created by Alan James Salmoni on 19/01/2017.
//  Copyright Â© 2017 Evgenii Neumerzhitckii. All rights reserved.
//

import XCTest
import SigmaSwiftStatistics

class QuantilesTests: XCTestCase {
  
  func testQuantile1() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 1) {
      XCTAssertEqualWithAccuracy(0.7165671, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile2() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 2) {
      XCTAssertEqualWithAccuracy(0.7175512, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile3() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 3) {
      XCTAssertEqualWithAccuracy(0.7165671, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile4() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 4) {
      XCTAssertEqualWithAccuracy(0.7165671, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile5() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 5) {
      XCTAssertEqualWithAccuracy(0.7175512, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile6() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 6) {
      XCTAssertEqualWithAccuracy(0.7181416, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile7() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 7) {
      XCTAssertEqualWithAccuracy(0.7169607, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile8() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 8) {
      XCTAssertEqualWithAccuracy(0.717748, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
  
  func testQuantile9() {
    let data_array = [0.52662978,  0.77362142,  0.57550701, 0.04158415,  0.03447811,
                      0.08848505,  0.5236469 ,  0.25523548,  0.89229563,  0.71272614,
                      0.17107995,  0.26764894,  0.27308645,  0.38404429,  0.12755542,
                      0.9856573 ,  0.91394384,  0.50584635,  0.31623642,  0.13751698,
                      0.68101821,  0.71853529,  0.66112074,  0.71656707,  0.35927775,
                      0.76151524,  0.94317209,  0.01808385,  0.36550638,  0.9901121 ,
                      0.60259119,  0.62285146,  0.61310069,  0.55510847,  0.15929895,
                      0.80369179,  0.26319102,  0.49952759,  0.34527164,  0.08919652,
                      0.61979169,  0.43286263,  0.42874006,  0.1784381 ,  0.51625026,
                      0.74231264,  0.34506245,  0.70310094,  0.09531878,  0.02909812]
    let alpha_value = 0.80
    if let result = Sigma.quantile(data: data_array, alpha: alpha_value, qtype: 9) {
      XCTAssertEqualWithAccuracy(0.7176988, result, accuracy: 0.0000001)
    }
    else {
      XCTAssertNil(nil)
    }
  }
}
